UK TOP SECRET STRAPl COMINT

OPC—M/TECHB/61

this choice is slightly arbitrary but does match the timing precision reported by most
SIGINT systems. In each bin we then have a pair (Eh G?) where E is the cumulative
exit node packet count at time i and Gi is the cumulative guard node packet count at
time if.

Our primary measure of association is the correlation between E and G1: as measured
by the Pearson product—moment correlation coefﬁcient T. we expect that when the two
trafﬁc streams are associated that a very high correlation coefﬁcient will result. We
note that high correlation coefﬁcients are generally expected as we’re comparing two
increasing sequences.

To remove false positives we also ﬁt the following basic linear model:

Gi : Of + SEE: (1)

we then use 6 to discard bad matches. we expect that a similar number of packets are
expected in both traces , we only consider traces where 1/2 < ,8 < 2.

A key consideration is how to handle guard node and exit node traces that do not
precisely overlap. We are assuming that our exit node trace is the complete log of a
TOR circuit. On the other hand, the guard node trace may contain trafﬁc for other
TOR circuits. We therefore truncate the guard node trace to the period of the exit node
trace. we also pad the guard node packet counts with zero if required to span the exit
node trace.

In addition we consider score all possible time shifts of the guard node trace against
the exit node trace — i.e. trying out different timing offsets. we do this as we do not
know the clock offset in our truth data set and to be as generous as possible in finding
false positives in the bulk logs. It is not known whether such a sliding approach may
prove useful in practice with known clock offsets; it is possible that such an approach
may also combat unknown delays in the TOR network.

7 Results

we ﬁrst show results of the proposed technique on our truth data set and then consider
false positive rates.

As mentioned above we will slide the putative guard node and exit nodes traces
against each other to allow for an unknown clock offset between the client and HTTP
proxy in the truth data set and to give us the maximum number of comparisons when
trying to assess the false positive rate.

7.1 True positives in the truth data

The ﬁrst experiments are to understand the behaviour of the algorithm on the truth
data. In ﬁgure 5 we show plots of T2 and ,8 as the time offset is varied. It can be seen

13
This information is exempt under the Freedom of Information A 7
information legislation. Refer any FOIA queries to GCI IQ on

