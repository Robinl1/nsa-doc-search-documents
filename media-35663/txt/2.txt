SNIPS of SIGINT :: (U) Monthly Notes for June 2012

 

TOP SECRET/[SI]
\UI I'IUIIIIIIy I‘UIGD IUI UUIIG LU IL

Entry tags: monthly notes
Technical accomplishments

 

(U/ /FOUO) PITIED FOOL

0 (TS/ / Sl/ / REL) PITIEDFOOL is a suite of CNA tools l'm developing for
use against file systems, initially focused on Windows. More information
can be found on the DSD wiki, but it's a bit ugly at this point.

0 (TS/ / SI/ / REL) Determined that it was a combination of the volume
shadow copy and deleted entries in the shadow copy that were causing
my recovery woes. As a result of the shadow copy having large chunks of
MFT data in it, and much of these records still being mostly correct,
recovery programs were able to reconstruct most of the system drive. I
added functionality to PITIEDFOOL to overwrite the contents of the
shadow copy on each partition encountered.

0 (TS/ / SI/ / REL) Now that I was overwriting large chunks of data for
every partition, I could no longer ignore the performance issues with
writing to a disk one sector at a time. I refactored my code to overwrite in
blocks configurable by a pre—processor definition and sped up execution
about 15—fold, with the possiblity of it going even faster with increased
memory usage.

0 (TS/ / Sl/ / REL) After all this I tested PITIEDFOOL within FUZZYEBOLA
and it worked ﬂawlessly. I took a build of FUZZYEBOLA from last
month, and without recompiling inserted the PITIEDFOOL binary with
configuration details to execute it at a certain time. At that time I saw the
process usage slightly increase (from 0% to around 2%) and a few minutes
later the system rebooted and didn't come back up. Running a file
recovery tool over the entire drive yielded some files (from scraping
headers) but nearly the entire contents of the drive were irrecoverable,
and if it had been conﬁgured to securely wipe every sector on the drive
after killing the MFT and VSS it wouldn't have been able to recover
anything at all. Success!

0 (U/ /FOUO) Documented my work.

(U/ /FOUO) PANT SPARTY

0 (TS/ / Sl/ / REL) PANT SPARTY is a backdoor in the SSH daemon for
*NIX, based on OpenSSH portable. It allows a public key to be embedded
in the sshd binary and will then always grant a root login shell if
presented with the proper key pair for that key. In other words, it behaves
as if the given key is in ~/ .ssh/authorized_keys.

0 (TS/ / SI/ / REL) Currently DSD uses authorized_keys as a quick—and—easy
method of persistence against certain *NIX targets. In most cases this

20f5

