TOP SECRETHCOMINTHREL TO USA, AUS, CAN, GBR, NZLl'l'20291123

4.0 (U) SUMMARY

The FIP currently recognizes UDP, TCP, and ESP as valid Network Layer protocols, and currently
sessionizes those packet types. The new requirement for lPiAHiESP will require changes to the PIP to
recognize AH as a valid layer, and will also require changes to the DFCE to allow those packets through.

There has been talk of having application-specific demuxes developed and inserted into the TE to
perform any required sessionization beyond the Transport Layer. For example, the ESP demux would be
responsible for sessionizing on Spi value.

The Table below summarizes the various protocol stacks, the parts of the stacks that are used in PPF
keyword detection. and how the associated packets should be sessionized.

 

Protocol Stack

Keyword Detection Layers

Sessionization Requirements

 

 

IPIESP IP, ESP IP Next Protocol 2 50
IP Source Address
lP Destination Address
ESP Spi

lP/AH/ESP lP, AH, ESP lP Next Protocol = 51

IP Source Address

IP Destination Address
AH Next Header = 50
AH Spi

ESP Spi

 

IPIUDPIISAKMP

* we have separate keywords for
ISAKMP Versions 1.0 and 9.9

IP, UDP, ISAKMP

IP Next Protocol 2 17
IP Source Address

lP Destination Address
UDP Source Port

UDP Destination Port

 

 

IPIUDPInullsHSAKMP

* we have separate keywords for
ISAKMP Versions 1.0 and 9.9

 

IP, UDP, ISAKMP

 

IP Next Protocol 2 17
IP Source Address

lP Destination Address
UDP Source Port

UDP Destination Port

 

PAGE 17 OF 18

TOP SECRETHCOMINTNREL TO USA, AUS, CAN, GBR, NZLl'l'20291123

 

